using Inedo.Extensibility.VulnerabilitySources;
using Inedo.Feeds;

namespace Inedo.Extension.Clair.VulnerabilitySources
{
    public sealed class ClairVulnerabilityInfo : VulnerabilityInfo
    {
        public ClairVulnerabilityInfo(string Id, FeedType feedType, string packageName, string title, string description, string severity, decimal? score)
        {
            this.Id = Id;
            this.FeedType = feedType;
            this.PackageName = packageName;
            this.Title = title;
            this.Description = description;
            this.Score = score ?? (severity switch
            {
                "Low" => 3.9m,
                "Medium" => 6.9m,
                "High" => 8.9m,
                "Critical" => 10.0m,
                "None" => 0.0m,
                _ => null
            });
        }

        public override string Id { get; }

        public override FeedType FeedType { get; }

        public override string PackageName { get; }

        public override VulnerabilityPackageVersionRange PackageVersions => new VulnerabilityPackageVersionRange();

        public override string Title { get; }

        public override string Description { get; }

        public override decimal? Score { get; }
    }

}
